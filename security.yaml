AWSTemplateFormatVersion: "2010-09-09"
Description: The Product Security Stack
Parameters:
  CreationDate:
    Description: Date
    Type: String
    Default: '2019-02-05 08:00:00'
    AllowedPattern: "^\\d{4}(-\\d{2}){2} (\\d{2}:){2}\\d{2}$"
    ConstraintDescription: Date and time of creation
  CloudTrailBucketName:
    Description: Enter in a name for your bucket. It must be globally unique, 3-63 characters long, and can contain only lower-case characters, numbers, periods, and dashes.
    Type: String
Resources:
  S3CloudTrail:
    Type: "AWS::S3::Bucket"
    DeletionPolicy: Retain # RETAIN when you delete the CF stack
    Properties:
      BucketName: !Ref CloudTrailBucketName
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: "AES256"
      VersioningConfiguration:
        Status: Enabled
      Tags:
        -
          Key: "Name"
          Value: !Ref CloudTrailBucketName #Enter your bucket name here
        -
          Key: "Description"
          Value: "S3 Bucket for CloudTrail" #Enter your description here
  S3CloudTrailPolicy:
    Type: AWS::S3::BucketPolicy
    Properties: 
      Bucket: !Ref S3CloudTrail
      PolicyDocument:
        Statement:
        - Sid: Stmt1533652298100
          Action: s3:*
          Effect: Deny
          Resource:
            !Sub |-
              arn:aws:s3:::${S3CloudTrail}
          Condition:
            Bool:
              aws:SecureTransport: 'false'
          Principal: "*"
        - Sid: "AWSCloudTrailAclCheck"
          Effect: "Allow"
          Principal: 
            Service: "cloudtrail.amazonaws.com"
          Action: "s3:GetBucketAcl"
          Resource: 
            !Sub |-
              arn:aws:s3:::${S3CloudTrail}
        - Sid: "AWSCloudTrailWrite"
          Effect: "Allow"
          Principal: 
            Service: "cloudtrail.amazonaws.com"
          Action: "s3:PutObject"
          Resource:
            !Sub |-
              arn:aws:s3:::${S3CloudTrail}/AWSLogs/${AWS::AccountId}/*
          Condition: 
            StringEquals:
              s3:x-amz-acl: "bucket-owner-full-control"
  myVPCCloudWatch:
    Type: AWS::Logs::LogGroup
    Properties: 
      LogGroupName: cloudtrail-mgmt-logs
      RetentionInDays: 180
  CloudTrailCloudWatchLogsRole:
    Type: "AWS::IAM::Role"
    Properties:
      RoleName: CloudTrail_CloudWatchLogs_Role
      AssumeRolePolicyDocument:
        Version: "2012-10-17"
        Statement:
          -
            Effect: "Allow"
            Principal:
              Service:
                - "vpc-flow-logs.amazonaws.com"
                - "cloudtrail.amazonaws.com"
            Action: 
              - "sts:AssumeRole"
      Path: "/"
      Policies: 
        - 
          PolicyName: "cloudtrail-mgmt-logs-policy"
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Sid: AWSCloudTrailCreateLogStream
              Effect: Allow
              Action:
              - logs:CreateLogStream
              Resource:
                !Sub |-
                  arn:aws:logs:us-west-2:${AWS::AccountId}:log-group:cloudtrail-mgmt-logs:log-stream:${AWS::AccountId}_CloudTrail_us-west-2*
            - Sid: AWSCloudTrailPutLogEvents
              Effect: Allow
              Action:
              - logs:PutLogEvents
              Resource:
                !Sub |-
                  arn:aws:logs:us-west-2:${AWS::AccountId}:log-group:cloudtrail-mgmt-logs:log-stream:${AWS::AccountId}_CloudTrail_us-west-2*
        - 
          PolicyName: CloudTrail_CloudWatchLogs_Policy
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Action:
              - logs:CreateLogGroup
              - logs:CreateLogStream
              - logs:PutLogEvents
              - logs:DescribeLogGroups
              - logs:DescribeLogStreams
              Effect: Allow
              Resource: "*"
  myTrail: 
    DependsOn: 
      - S3CloudTrailPolicy
      - SNSPolicy
    Type: AWS::CloudTrail::Trail
    Properties: 
      S3BucketName: 
        Ref: S3CloudTrail
      SnsTopicName: 
        Fn::GetAtt: 
          - CloudTrailSNS
          - TopicName
      IsLogging: true
      IsMultiRegionTrail: true
      IncludeGlobalServiceEvents: true
      TrailName: mgmt-cloudtrail
      KMSKeyId: alias/s3-mgmt-cloudtrail-kms
      EnableLogFileValidation: true
      CloudWatchLogsLogGroupArn: 
        !Sub |-
          arn:aws:logs:us-west-2:${AWS::AccountId}:log-group:cloudtrail-mgmt-logs:*
      CloudWatchLogsRoleArn: 
        !Sub |-
          arn:aws:iam::${AWS::AccountId}:role/CloudTrail_CloudWatchLogs_Role
      EventSelectors:
        - DataResources:
          - Type: AWS::S3::Object
            Values:
                - 'arn:aws:s3'
        - ReadWriteType: All
  CloudTrailSNS:
    Type: AWS::SNS::Topic
    Properties: 
      TopicName: sns-mgmt-cloudtrail
  SNSPolicy: 
    Type: AWS::SNS::TopicPolicy
    Properties: 
      Topics: 
        - Ref: "CloudTrailSNS"
      PolicyDocument: 
        Version: "2012-10-17"
        Statement: 
          - Sid: __default_statement_ID
            Effect: Allow
            Principal:
              AWS: "*"
            Action:
            - SNS:GetTopicAttributes
            - SNS:SetTopicAttributes
            - SNS:AddPermission
            - SNS:RemovePermission
            - SNS:DeleteTopic
            - SNS:Subscribe
            - SNS:ListSubscriptionsByTopic
            - SNS:Publish
            - SNS:Receive
            Resource: 
              !Sub |-
                ${CloudTrailSNS}
            Condition:
              StringEquals:
                AWS:SourceOwner: 
                  !Sub |-
                    '${AWS::AccountId}'
          - Sid: "AWSCloudTrailSNSPolicy"
            Effect: "Allow"
            Principal: 
              Service: "cloudtrail.amazonaws.com"
            Resource: 
              !Sub |-
                ${CloudTrailSNS}
            Action: "SNS:Publish"
  CloudWatchAlarmSNS:
    Type: AWS::SNS::Topic
    Properties: 
      TopicName: sns-mgmt-cloudwatch-alarms
  CloudWatchAlarmSNSPolicy: 
    Type: AWS::SNS::TopicPolicy
    Properties: 
      Topics: 
        - Ref: "CloudWatchAlarmSNS"
      PolicyDocument: 
        Version: "2012-10-17"
        Statement: 
          - Sid: __default_statement_ID
            Effect: Allow
            Principal:
              AWS: "*"
            Action:
            - SNS:GetTopicAttributes
            - SNS:SetTopicAttributes
            - SNS:AddPermission
            - SNS:RemovePermission
            - SNS:DeleteTopic
            - SNS:Subscribe
            - SNS:ListSubscriptionsByTopic
            - SNS:Publish
            - SNS:Receive
            Resource: 
              !Sub |-
                ${CloudWatchAlarmSNS}
            Condition:
              StringEquals:
                AWS:SourceOwner: 
                  !Sub |-
                    '${AWS::AccountId}'
          - Sid: "AWSCloudWatchSNSPolicy"
            Effect: "Allow"
            Principal: 
              Service: "cloudwatch.amazonaws.com"
            Resource: 
              !Sub |-
                ${CloudWatchAlarmSNS}
            Action: "SNS:Publish"
# 3.1 Ensure a log metric filter and alarm exist for unauthorized API calls
  MetricUnauthAPI:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.errorCode = "*UnauthorizedOperation") || ($.errorCode = "AccessDenied*") }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "unauthorized_api_calls_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  UnauthAPIAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: unauthorized_api_calls_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: unauthorized_api_calls_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.2 Ensure a log metric filter and alarm exist for Management Console sign-in without MFA
  MetricNoMFASignIn:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventName = "ConsoleLogin") && ($.additionalEventData.MFAUsed != "Yes") }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "no_mfa_console_signin_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  NoMFASignInAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: no_mfa_console_signin_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: no_mfa_console_signin_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.3 Ensure a log metric filter and alarm exist for usage of "root" account
  MetricRootUsage:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ $.userIdentity.type = "Root" && $.userIdentity.invokedBy NOT EXISTS && $.eventType != "AwsServiceEvent" }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "root_usage_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  RootUsageAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: root_usage_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: root_usage_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.4 Ensure a log metric filter and alarm exist for IAM policy changes
  MetricIAMChanges:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventName=DeleteGroupPolicy) || ($.eventName=DeleteRolePolicy) || ($.eventName=DeleteUserPolicy) || ($.eventName=PutGroupPolicy) || ($.eventName=PutRolePolicy) || ($.eventName=PutUserPolicy) || ($.eventName=CreatePolicy) || ($.eventName=DeletePolicy) || ($.eventName=CreatePolicyVersion) || ($.eventName=DeletePolicyVersion) || ($.eventName=AttachRolePolicy) || ($.eventName=DetachRolePolicy) || ($.eventName=AttachUserPolicy) || ($.eventName=DetachUserPolicy) || ($.eventName=AttachGroupPolicy) || ($.eventName=DetachGroupPolicy) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "iam_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  IAMChangesAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: iam_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: iam_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.5 Ensure a log metric filter and alarm exist for CloudTrail configuration changes
  MetricCloudTrailCfgChange:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) || ($.eventName = StartLogging) || ($.eventName = StopLogging) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "cloudtrail_cfg_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  CloudTrailCfgChangeAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: cloudtrail_cfg_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: cloudtrail_cfg_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.6 Ensure a log metric filter and alarm exist for AWS Management Console authentication failures
  MetricConsoleAuthFail:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventName = ConsoleLogin) && ($.errorMessage = "Failed authentication") }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "console_signin_failure_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  ConsoleAuthFailAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: console_signin_failure_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: console_signin_failure_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.7 Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs
  MetricDisableCMK:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{($.eventSource = kms.amazonaws.com) && (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion)) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "disable_or_delete_cmk_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  DisableCMKAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: disable_or_delete_cmk_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: disable_or_delete_cmk_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.8 Ensure a log metric filter and alarm exist for S3 bucket policy changes
  MetricS3PolicyChange:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventSource = s3.amazonaws.com) && (($.eventName = PutBucketAcl) || ($.eventName = PutBucketPolicy) || ($.eventName = PutBucketCors) || ($.eventName = PutBucketLifecycle) || ($.eventName = PutBucketReplication) || ($.eventName = DeleteBucketPolicy) || ($.eventName = DeleteBucketCors) || ($.eventName = DeleteBucketLifecycle) || ($.eventName = DeleteBucketReplication)) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "s3_bucket_policy_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  S3PolicyChangeAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: s3_bucket_policy_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: s3_bucket_policy_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.9 Ensure a log metric filter and alarm exist for AWS Config configuration changes
  MetricAWSConfigChange:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventSource = config.amazonaws.com) && (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel) ||($.eventName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder)) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "aws_config_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  AWSConfigAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: aws_config_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: aws_config_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.10 Ensure a log metric filter and alarm exist for security group changes
  MetricSGChange:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventName = AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName = RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName = CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "security_group_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  SGChangeAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: security_group_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: security_group_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.11 Ensure a log metric filter and alarm exist for changes to Network Access Control Lists 
  MetricNACLChange:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventName = CreateNetworkAcl) || ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName = DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName = ReplaceNetworkAclAssociation) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "nacl_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  NACLChangeAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: nacl_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: nacl_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.12 Ensure a log metric filter and alarm exist for changes to network gateways 
  MetricGWChange:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventName = CreateCustomerGateway) || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) || ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName = DetachInternetGateway) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "network_gw_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  GWChangeAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: network_gw_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: network_gw_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.13 Ensure a log metric filter and alarm exist for route table changes
  MetricRouteTableChange:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "route_table_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  RouteTableChangeAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: route_table_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: route_table_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
# 3.14 Ensure a log metric filter and alarm exist for VPC changes
  MetricVPCChange:
    Type: AWS::Logs::MetricFilter
    Properties: 
      FilterPattern: '{ ($.eventName = CreateVpc) || ($.eventName = DeleteVpc) || ($.eventName = ModifyVpcAttribute) || ($.eventName = AcceptVpcPeeringConnection) || ($.eventName = CreateVpcPeeringConnection) || ($.eventName = DeleteVpcPeeringConnection) || ($.eventName = RejectVpcPeeringConnection) || ($.eventName = AttachClassicLinkVpc) || ($.eventName = DetachClassicLinkVpc) || ($.eventName = DisableVpcClassicLink) || ($.eventName = EnableVpcClassicLink) }'
      LogGroupName: !Ref myVPCCloudWatch
      MetricTransformations: 
        - 
          MetricName: "vpc_changes_metric"
          MetricNamespace: "CISBenchmark"
          MetricValue: "1"
  VPCAlarm:
    Type: AWS::CloudWatch::Alarm
    Properties: 
      AlarmName: vpc_changes_alarm
      AlarmActions:
        - !Ref CloudWatchAlarmSNS
      ComparisonOperator: GreaterThanOrEqualToThreshold
      EvaluationPeriods: 1
      MetricName: vpc_changes_metric
      Namespace: CISBenchmark
      Period: 300
      Statistic: Sum
      Threshold: 1
  ConfigRole:
    Type: AWS::IAM::Role
    Properties:
      RoleName: ConfigRole
      Path: "/"
      AssumeRolePolicyDocument: 
        Version: '2012-10-17'
        Statement:
        - Sid: ''
          Effect: Allow
          Principal:
            Service: config.amazonaws.com
          Action: sts:AssumeRole
      Policies:
        - 
          PolicyName: "root"
          PolicyDocument:
            Version: '2012-10-17'
            Statement:
            - Effect: Allow
              Action:
              - s3:PutObject
              Resource:
                !Sub |-
                  arn:aws:s3:::${S3CloudTrail}/AWSLogs/${AWS::AccountId}/*
              Condition:
                StringLike:
                  s3:x-amz-acl: bucket-owner-full-control
            - Effect: Allow
              Action:
              - s3:GetBucketAcl
              Resource: 
                !Sub |-
                  arn:aws:s3:::${S3CloudTrail}
  # ConfigDelivery:
  #   Type: AWS::Config::DeliveryChannel
  #   Properties:
  #     S3BucketName: !Ref S3CloudTrail
Outputs:
  CloudTrailRoleOutput:
    Description: CloudTrail CloudWatch Logs Role
    Value: !Ref CloudTrailCloudWatchLogsRole
    Export:
      Name: cloudtrail-role